<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <nav>
    <div class="nav-title">Inventory Dashboard</div>
    <div>
      Hello, {{ session.get('user_id') }} |
      <a href="{{ url_for('logout') }}" class="nav-link">Logout</a>
    </div>
  </nav>
  <main>
    <div class="inventory-box">
      <h2>Product Inventory</h2>
          <!-- SEARCH FORM -->
      <form method="get" class="top-bar">
        <div class="search-container">
        <input type="text" placeholder="Search by name, SKU, or ID">
        <button class="search-btn">Search</button>
        <button id="addProductBtn" class="add-btn">+ Add Product</button>
      </div>
      </form>
      <script>
  // Replace with actual role from your backend or login logic
        const userRole = "admin"; // or "user"

        const addBtn = document.getElementById("addProductBtn");

        if (userRole !== "admin") {
          addBtn.disabled = true;
          addBtn.style.opacity = "0.6";
          addBtn.style.cursor = "not-allowed";
          addBtn.title = "Only admins can add products";
        } else {
    // ✅ ACTION: Add your form opening logic here
          addBtn.addEventListener("click", function () {
            window.location.href = "/add_product.html";
      // Example: show modal or redirect to another page
      // window.location.href = "/add-product.html";
    });
  }
</script>

      <!-- TABLE -->
      <table class="inventory-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>SKU</th>
            <th>Stock</th>
            <th>Location</th>
            <th>Status</th>
            <th>Price</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for product in inventory %}
          <tr>
            <td>{{ product.name }}</td>
            <td>{{ product.sku }}</td>
            <td>{{ product.stock }}</td>
            <td>{{ product.location }}</td>
            <td><span class="status">{{ product.status }}</span></td>
            <td>
              <span class="{% if product.price_change == 'increase' %}price-up{% elif product.price_change == 'decrease' %}price-down{% endif %}">
                ₹{{ product.dynamic_price }}
              </span>
            </td>
            <td>
              <a href="{{ url_for('product_detail', pid=product.id) }}"><button class="btn">View</button></a>
              {% if role == 'developer' %}
              <a href="{{ url_for('edit_product', pid=product.id) }}"><button class="btn btn-edit">Edit</button></a>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <script>
        </script>
      </script>
    </div>
  </main>
</body>
</html>
